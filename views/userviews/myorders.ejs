<%- include('./header') %>

<style>

.css-ibwr57 {
    
    font-size: 14px;
    padding: 10px 16px;
    width: 35%;
    letter-spacing: 1px;
    font-weight: 700;
    border-radius: 2px;
    border-width: 0px;
    background-color: rgb(12, 8, 9);
    color: rgb(255, 255, 255);
    cursor: pointer;
}
</style>

<section class="h-100 gradient-custom">
  <div class="container py-5 h-100" style="margin-top: 60px;">
    <div class="row d-flex justify-content-center align-items-center h-100">
      <div class="col-lg-10 col-xl-8">
        <div class="card" style="border-radius: 10px;">
          <div class="card-body p-4">
            <div class="d-flex justify-content-between align-items-center mb-4">
              <p class="lead fw-normal mb-0" style="color: #a8729a;">Order History</p>
            </div>

            <% orders.sort((a, b) => b.orderdate - a.orderdate).forEach((order) => { %>
              <div class="card shadow-0 border mb-4">
                <div class="card-body">
                  <p class="text-muted mb-0 small">Order Date: <%= order.orderdate.toLocaleDateString() %></p>

                  <% order.items.forEach((item) => { %>
                    <div class="row">
                      <div class="col-md-2">
                        <img src="/<%= item.product.images[0] %>" class="img-fluid" alt="Phone">
                      </div>
                      <div class="col-md-2 text-center d-flex justify-content-center align-items-center">
                        <p class="text-muted mb-0"><%= item.product.name %></p>
                      </div>
                      <div class="col-md-2 text-center d-flex justify-content-center align-items-center">
                        <p class="text-muted mb-0 small">Qty: <%= item.quantity %></p>
                      </div>
                      <div class="col-md-2 text-center d-flex justify-content-center align-items-center">
                        <p class="text-muted mb-0 small">&#8377;<%= item.product.price * item.quantity %></p>
                      </div>


                    </div>
                    <hr class="mb-4" style="background-color: #e0e0e0; opacity: 1;">
                  <% }); %>

                  <div class="row d-flex align-items-center">
                    <div class="col-md-4">
                      <p class="text-muted mb-0 small">Payment Method: <%= order.paymentMethod %></p>
                      <p class="text-muted mb-0 small">Order Status: <%= order.orderStatus %></p>
                    </div>
                    <div class="col-md-8 text-right">
                        <a href="/orderdetails/<%= order._id %>" class="btn btn-primary">View Details</a>
                        <button class="css-ibwr57" onclick="cancelOrder('<%= order._id %>')">Cancel Order</button>
                      </div>
                  </div>
                </div>
              </div>
            <% }); %>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>
